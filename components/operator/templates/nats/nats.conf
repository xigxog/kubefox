# NATS Clients Port
port: 4222

# PID file shared with configuration reloader.
pid_file: "/var/run/nats/nats.pid"

# Monitoring
http_port:   8222
server_name: $KUBEFOX_POD

lame_duck_duration:     30s
lame_duck_grace_period: 0s

max_payload: {{ .Values.maxContentSize | default "10Mi" }}

{{- if eq .Logger.Level "debug" }}
debug: true
{{- end }}

# NATS JetStream
jetstream {
    max_memory_store: 0
    max_file_store:   {{ .Values.volumeSize | default "1Gi" }}
    store_dir: "/data"
}

tls {
    cert_file: "{{ homePath }}/tls.crt"
    key_file:  "{{ homePath }}/tls.key"
    ca_file:   "{{ homePath }}/ca.crt"
    verify_and_map: true
}

authorization {
    users = [
        {user: "{{ .Platform.Name }}-broker.{{ .Platform.Namespace }}"}
    ]
}